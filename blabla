library(future)
library(lubridate)
library(dplyr)
library(tidyr)
library(purrr)
library(stringr)




#' An example for a sim_fn function
#' @param setting_param_list parameters that changes at each run
#' @param other_param_list static parameters for all the runs
#' @param nworkers number of cpus to use
#' @return a tibble with the results and also save an RDS of the results



run_sim <- function(sim_fn,setting_param_list,nworkers = 70){
  
  
  future::plan("multiprocess",workers =  min(nworkers,availableCores()-1))
  # the function safely used to avoid program failing.
  sim_fn <- purrr::safely(sim_fn)
